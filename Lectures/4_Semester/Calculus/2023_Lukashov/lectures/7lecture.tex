\begin{definition}
	\textit{Гильбертовым пространством} называется любое полное бесконечномерное евклидово пространство
\end{definition}

\begin{corollary}
	$L_2[a; b]$ является гильбертовым пространством со скалярным произведением, определённым таким образом:
	\[
		\tbr{f, g} = \int_{[a; b]} f(x)g(x)d\mu(x)
	\]
\end{corollary}

\begin{theorem}
	Имеют место следующие утверждения:
	\begin{enumerate}
		\item В пространстве $L_p[a; b]$ всюду плотны множества непрерывных функций, многочленов с рациональными коэффициентами
		
		\item В пространстве $L_p(\R)$ всюду плотно множество непрерывных финитных функций
		
		\item В пространстве $L_p[-\pi; \pi]$ всюду плотно множество тригонометрических полиномов
	\end{enumerate}
\end{theorem}

\begin{proof}~
	\begin{enumerate}
		\item Мы уже доказывали всюду плотность множества непрерывных функций в $L_1[a; b]$ в самом начале семестра, доказательство аналогично
		
		\item \textcolor{red}{Остальные без доказательства или что?}
	\end{enumerate}
\end{proof}

\begin{theorem} (Вейерштрасса)
	Множество многочленов с действительными коэффициентами всюду плотно в $C[a; b]$
\end{theorem}

\begin{definition}
	Последовательность $\{\phi_n\}_{n = 1}^\infty \subseteq E$ называется \textit{полной в ЛНП $E$}, если выполнено условие:
	\[
		\forall \eps > 0\ \forall f \in E\ \exists P = \sum_{k = 1}^n c_k\phi_k \such \|P - f\|_E < \eps
	\]
\end{definition}

\begin{corollary}
	Мы уже знаем некоторые полные системы:
	\begin{enumerate}
		\item Система $\{1, x, x^2, \ldots\}$ полна в $C[a; b]$ и $L_p[a; b],\ 1 \le p < \infty$
		
		\item Система $\{1 / 2, \cos(kx), \sin(kx)\}_{k = 1}^\infty$ полна в $C_{2\pi}$ и $L_p[-\pi; \pi],\ 1 \le p < \infty$
	\end{enumerate}
\end{corollary}

\subsection{Ряды Фурье в евклидовых пространствах}

\begin{reminder}
	Векторное пространство $V$ называется \textit{евклидовым}, если оно снабжено симметричной билинейной положительно определённой формой $\tbr{\cdot, \cdot}$, называемой \textit{скалярным произведением}.
\end{reminder}

\begin{note}
	Далее мы используем $E$ как стандартное обозначение евклидова пространства
\end{note}

\begin{reminder}
	Любое евклидово пространство $E$ можно сделать линейно нормированным, введя такую норму:
	\[
		\forall v \in E\ \ \|v\| := \sqrt{\tbr{v, v}}
	\]
\end{reminder}

\begin{definition}
	Система элементов $\{e_n\}_{n = 1}^\infty \subseteq E$ называется \textit{ортогональной}, если элементы попарно ортогональны:
	\[
		\forall n \neq m\ \ \tbr{e_n, e_m} = 0
	\]
\end{definition}

\begin{definition}
	Ортогональная система $\{e_n\}_{n = 1}^\infty \subseteq E$ называется \textit{ортонормированной}, если нормы всех элементов равны единице:
	\[
		\forall n \in \N\ \ \|e_n\| = \tbr{e_n, e_n} = 1
	\]
\end{definition}

\begin{definition}
	Пусть $\{e_n\}_{n = 1}^\infty \subseteq E$ --- ортогональная система, то \textit{коэффициентами Фурье для элемента $f \in E$} мы будем называть коэффициенты от проекции $f$ на $e_n$:
	\[
		f_n := \frac{\tbr{f, e_k}}{\tbr{e_k, e_k}} = \frac{\tbr{f, e_k}}{\|e_k\|^2}
	\]
\end{definition}

\begin{definition}
	Пусть $f \in E$ и $\{e_n\}_{n = 1}^\infty \subseteq E$. Тогда \textit{общим рядом Фурье для $f$ по системе $\{e_n\}_{n = 1}^\infty$} называется ряд $\sum_{k = 1}^\infty f_ke_k$
\end{definition}

\begin{proposition}
	Имеют место следующие свойства:
	\begin{enumerate}
		\item Если $f = \sum_{k = 1}^\infty c_ke_k$, а $\{e_k\}_{k = 1}^\infty$ --- это ортогональная система, то $c_k = f_k$ для любого $k \in \N$
		
		\item Любая ортогональная система является линейно независимой
		
		\item Если за $S_n(f)$ обозначить частичную сумму общего ряда Фурье, то для любого полинома $T = \sum_{k = 1}^n c_ke_k$ выполнено равенство $S_n(T) = T$
	\end{enumerate}
\end{proposition}

\begin{proof}~
	\begin{enumerate}
		\item При равенстве мы имеем право навесить скалярное произведение с обеих сторон, но для ряда мы не можем гарантировать, что вынесение суммы за скобки не сломает равенство. Поэтому мы будем пользоваться частичными суммами:
		\[
			f = \sum_{k = 1}^\infty c_ke_k := \lim_{n \to \infty} \sum_{k = 1}^n c_ke_k
		\]
		Теперь покажем, что мы формально можем вынести предел за скалярное произведение, но сделаем это хитро:
		\[
			\md{\tbr{f - \sum_{k = 1}^n c_ke_k, e_m}} \le \no{f - \sum_{k = 1}^n c_ke_k} \cdot \|e_m\| \to 0,\ n \to \infty \Lora \lim_{n \to \infty} \tbr{f - \sum_{k = 1}^n c_ke_k, e_m} = 0
		\]
		Итак, по линейности у нас будет $\tbr{f, e_m}$ и скалярное произведение с суммой. Понятно, что начиная с $n \ge m$, второе скалярное произведение будет просто $c_m\tbr{e_m, e_m}$, поэтому
		\[
			\lim_{n \to \infty} (\tbr{f, e_m} - c_m\tbr{e_m, e_m}) = 0 \Lra \tbr{f, e_m} = c_m\tbr{e_m, e_m} \Lra c_m = f_m
		\]
		
		\item Предположим противное, $0 = \sum_{k = 1}^\infty c_ke_k$. Но тогда все $c_k$ --- это коэффициенты Фурье для 0, то есть нули. Противоречие
		
		\item Пусть $T = \sum_{k = 1}^n c_ke_k$. Посмотрим просто на $\tbr{T, e_m},\ m \le n$. Тогда $\tbr{T, e_m} = c_m\tbr{e_m, e_m}$, то есть коэффициенты $T$ это его же коэффициенты Фурье
	\end{enumerate}
\end{proof}

\begin{theorem} (Минимальное свойство коэффициентов Фурье)
	Если $\{e_n\}_{n = 1}^\infty \subseteq E$ --- ортогональная система и $f \in E$, то для любого полинома $T = \sum_{k = 1}^m c_ke_k$ справедливо неравенство:
	\[
		\|T - f\| \ge \|S_m(f) - f\|
	\]
	причём равенство достигается только для $T = S_m(f)$
\end{theorem}

\begin{proof}
	Доказывать мы будем версию этого неравенства с квадратами (благо числа с обеих сторон неотрицательны, поэтому это эквивалентные вещи):
	\begin{multline*}
		\|f - T\|^2 = \tbr{f - \sum_{k = 1}^m c_ke_k, f - \sum_{k = 1}^m c_ke_k} = \tbr{f, f} - 2\sum_{k = 1}^m c_k \tbr{e_k, f} + \sum_{k = 1}^m c_k^2 \|e_k\|^2 =
		\\
		\|f\|^2 - \sum_{k = 1}^m f_k^2\|e_k\|^2 + \sum_{k = 1}^m c_k^2\|e_k\|^2 - 2\sum_{k = 1}^m c_kf_k\|e_k\|^2 + \sum_{k = 1}^m f_k^2\|e_k\|^2 =
		\\
		\|f\|^2 - \sum_{k = 1}^m f_k^2\|e_k\|^2 + \sum_{k = 1}^m (c_k - f_k)^2\|e_k\|^2 \ge \|f\|^2 - \sum_{k = 1}^m f_k^2\|e_k\|^2 = \|f - S_m(f)\|^2
	\end{multline*}
	Пояснения к переходам:
	\begin{itemize}
		\item Во второй строчке мы пользуемся определением коэффициентов $f_k$, а именно:
		\[
			f_k := \frac{\tbr{e_k, f}}{\tbr{e_k, e_k}} \Lora f_k\|e_k\|^2 = \tbr{e_k, f}
		\]
		А ещё мы добавили и вычли $\sum_{k = 1}^m f_k^2\|e_k\|^2$. Во второй строчке это второе и последнее слагаемое
		
		\item В последнем переходе мы воспользовались так называемым \textit{тождеством Бесселя}. Доказательство его тривиально
	\end{itemize}
\end{proof}

\begin{corollary} (Неравенство Бесселя)
	Если $\{e_n\}_{n = 1}^\infty \subseteq E$ --- ортогональная система в $E$, $f \in E$, то выполнено неравенство:
	\[
		\sum_{k = 1}^\infty f_k^2\|e_k\|^2 \le \|f\|^2
	\]
\end{corollary}

\begin{note}
	Все определения и результаты этого параграфа переносятся и на случай унитарных пространств
\end{note}

\begin{theorem}
	Пусть $\{e_k\}_{k = 1}^\infty \subseteq E$ --- ортогональная система, $f \in E$. Тогда следующие утверждения эквивалентны:
	\begin{enumerate}
		\item $\forall \eps > 0\ \exists T = \sum_{k = 1}^n c_ke_k \such \|f - T\| < \eps$
		
		\item $f = \sum_{k = 1}^\infty f_ke_k$, где $\{f_k\}_{k = 1}^\infty$ --- коэффициенты Фурье
		
		\item Справедливо \textit{равенство Парсеваля}: $\|f\|^2 = \sum_{k = 1}^\infty f_k^2\|e_k\|^2$
	\end{enumerate}
\end{theorem}

\begin{proof}~
	\begin{itemize}
		\item[$1 \La 2$] Тривиально
		
		\item[$1 \Ra 2$] За счёт предыдущей теоремы и условия мы сразу получаем утверждение:
		\[
			\forall \eps > 0\ \exists T = \sum_{k = 1}^N c_ke_k \such \|S_N(f) - f\| \le \|T - f\| < \eps
		\]
		Стало быть, есть и такое утверждение:
		\[
			\forall \eps > 0\ \exists N \in \N \such \forall n > N\ \ \|S_n(f) - f\| \le \|S_N(f) - f\| < \eps
		\]
		Что и требовалось показать
		
		\item[$2 \Lra 3$] Оба утверждения эквивалентны в силу тождества Бесселя:
		\[
			\forall m \in \N\ \ \|f\|^2 - \sum_{k = 1}^m f_k^2\|e_k\|^2 = \|f - S_m(f)\|^2
		\]
	\end{itemize}
\end{proof}

\begin{corollary}
	Пусть $\{e_k\}_{k = 1}^\infty \subseteq E$ --- ортогональная система. Тогда следующие утверждения эквивалентны:
	\begin{enumerate}
		\item $\{e_k\}_{k = 1}^\infty$ --- полна в $E$
		
		\item $\forall f \in E\ \ f = \sum_{k = 1}^\infty f_ke_k$, где $f_k$ --- коэффициенты Фурье
		
		\item $\forall f \in E\ \ \|f\|^2 = \sum_{k = 1}^\infty f_k^2\|e_k\|^2$, где $f_k$ --- коэффициенты Фурье
	\end{enumerate}
\end{corollary}

\begin{theorem} (Рисса-Фишера)
	Пусть $H$ --- гильбертово пространство, $\{e_k\}_{k = 1}^\infty \subseteq H$ --- ортогональная система. Тогда, для любой последовательности $\{f_k\}_{k = 1}^\infty \subseteq H$ такой, что ряд $\sum_{k = 1}^\infty f_k^2\|e_k\|^2$ сходится, существует элемент $f \in H$ такой, что $f_k$ являются коэффициентами Фурье для $f$.
\end{theorem}

\begin{proof}
	Покажем, что $f := \sum_{k = 1}^\infty f_ke_k$ обладает всеми требуемыми свойствами. Для этого нужно показать, что этот ряд сходится, то есть частичные суммы фундаментальны. В самом деле:
	\[
		\no{\sum_{k = n + 1}^{n + p} f_ke_k}^2 = \tbr{\sum_{k = n + 1}^{n + p} f_ke_k, \sum_{k = n + 1}^{n + p} f_ke_k} = \sum_{k = n + 1}^{n + p} f_k^2 \|e_k\|^2
	\]
	В силу последней суммы мы точно можем заявить требуемое (коль скоро по условию ряд $\sum_{k = 1}^\infty f_k^2 \|e_k\|^2$ сходится), что и требовалось.
\end{proof}

\begin{corollary}
	Пусть $H$ --- гильбертово пространство, $\{e_k\}_{k = 1}^\infty \subseteq H$ --- ортогональная система и $f \in H$. Тогда существует элемент $f_0 \in H$ такой, что верно 2 факта:
	\begin{enumerate}
		\item $f_0 = \sum_{k = 1}^\infty f_ke_k$, где $f_k$ --- коэффициенты Фурье для $f$
		
		\item $\forall m \in \N\ \tbr{f - f_0, e_m} = 0$
	\end{enumerate}
\end{corollary}

\begin{proof}
	Покажем существование $f_0$. Это тривиально по неравенству Бесселя и теореме Рисса-Фишера:
	\[
		\sum_{k = 1}^\infty f_k^2 \|e_k\|^2 \le \|f\|^2 \Lora \exists f_0 = \sum_{k = 1}^\infty f_ke_k
	\]
	Осталось проверить равенство со скалярным произведением:
	\[
		\tbr{f - f_0, e_m} = \tbr{f, e_m} - \tbr{f_0, e_m} = \tbr{f, e_m} - f_k\tbr{e_m, e_m} = 0
	\]
\end{proof}

\begin{definition}
	Система элементов $\{e_k\}_{k = 1}^\infty \subseteq E$ называется \textit{замкнутой}, если выполнено утверждение:
	\[
		\forall f \in E\ \ \ps{\forall k \in \N\ \tbr{f, e_k} = 0} \ra (f = 0) 
	\]
\end{definition}

\begin{theorem}
	Если $H$ --- гильбертово пространство, то для любой ортогональной системы $\{e_k\}_{k = 1}^\infty$ понятия полноты и замкнутости эквивалентны
\end{theorem}

\begin{proof}~
	\begin{itemize}
		\item[$\Ra$] В силу эквивалентных свойств полноты мы знаем, что
		\[
			\forall f \in H\ \ f = \sum_{k = 1}^\infty f_ke_k \text{, где $f_k$ --- коэффициенты Фурье}
		\]
		Стало быть, если $\tbr{f, e_k} = 0$, то $f_k = 0$ и коль скоро это для всех $k \in \N$, то $f = 0$
		
		\item[$\La$] В силу следствия теоремы Рисса-Фишера, верно следующее:
		\[
			\forall f \in H\ \exists f_0 \in H \such (\forall m \in \N\ \tbr{f - f_0, e_m} = 0) \wedge \ps{f_0 = \sum_{k = 1}^\infty f_ke_k}
		\]
		Раз $\forall m \in \N\ \tbr{f - f_0, e_m} = 0$, то $f - f_0 = 0$ в силу замкнутости, отсюда уже всё очевидно
	\end{itemize}
\end{proof}