\begin{proof} (через теорему Лузина \textcolor{red}{Пока не готово})
	Снова приближаем $f \in L_1[a; b]$. По теореме Лузина:
	\[
		\forall \eps > 0\ \exists E_\eps \subseteq [a; b] \such \mu([a; b] \bs E_\eps) < \eps \wedge \exists g_1 \in C(E_\eps) \such \forall x \in E_\eps\ f(x) = g_1(x)
	\]
	Идея состоит в том, чтобы взять какую-то основную часть $g_1	$ (в плане функцию со значениями $g_1$ на некотором подмножестве $E_\eps$) и дополнить её значениями до $[a; b]$ так, чтобы она была приближающей. При этом нам не то чтобы важно, что происходит за $[a; b]$, лишь бы функция была непрерывной и финитной. Поэтому мы построим функцию на $\R$, а затем подрежем её под $[a; b]$. Итак, $\exists F \subseteq E_\eps$ --- можно подобрать замкнутое множество таким, что $\mu(E_\eps \bs F) < \eps / 2$. Далее всё просто:
	\[
		\R \bs F \text{ --- открытое множество} \Ra \R \bs F = \bscup_{k = 1}^\infty (a_k; b_k)
	\]
	Теперь, определим $g$ --- продолжение $g_1$ на $\R$:
	\begin{itemize}
		\item $\forall x \in F\ \ g(x) = g_1(x)$
		
		\item $\forall x \in \R \bs F$ потребуем $g(a_k) = f(a_k)$ и $g(b_k) = f(b_k)$ (если эти граничные точки оказались в $F$, то такое определение согласовано по предыдущему пункту). Внутри $(a_k; b_k)$ просто скажем, что $g$ линейно соединяет граничные точки
	\end{itemize}
	Полученная функция непрерывна на $[a; b]$. Осталось проверить, что при любом $\eta > 0$ мы можем выбрать $\eps > 0$ и следовательно $g$, что она действительно хорошо приближает $f$ по норме $L_1[a; b]$ (не забудем учесть неравенство $\mu([a; b] \bs F) < \frac{3\eps}{2}$). Действительно, 
	\[
		\int_{[a; b] \bs F} |f(x) - g(x)|d\mu(x) \le \int_{[a; b] \bs F} |f(x)|d\mu(x) + \int_{[a; b] \bs F} |g(x)|d\mu(x)
	\]
	\textcolor{red}{Обработать доказательство.}
\end{proof}

\begin{lemma} \label{average_continuous}
	Каждая суммируемая на $\R$ функция $f \colon \R \to \R$ непрерывна в среднем, то есть имеет место предел:
	\[
		\exists \lim_{t \to 0} \int_\R |f(x + t) - f(x)|d\mu(x) = 0
	\]
\end{lemma}

\begin{proof}
	Разберёмся с простым случаем, а сложный сведём к нему:
	\begin{enumerate}
		\item $f \in L_1[a; b]$. Докажем наличие такого предела:
		\[
			\exists \lim_{t \to 0+} \int_{[a; b - t]} |f(x + t) - f(x)|d\mu(x) = 0
		\]
		По лемме о всюду плотности множества непрерывных финитных функций верно следующее:
		\[
			\forall \eps > 0\ \exists g \in C[a; b] \such \int_{[a; b]} |f(x) - g(x)|d\mu(x) < \frac{\eps}{3}
		\]
		Коль скоро $g$ будет непрерывной на отрезке, то по теореме Кантора она ещё и равномерно непрерывна:
		\[
			\forall \eps > 0\ \exists \delta > 0 \such \forall x, y \in [a; b], |x - y| < \delta\ \ |g(x) - g(y)| < \frac{\eps}{3(b - a)}
		\]
		Рассмотрим достаточно малое $0 < t < \delta$ и оценим соответствующий интеграл:
		\begin{multline*}
			\int_{[a; b - t]} |f(x + t) - f(x)|d\mu(x) \le \int_{[a; b - t]} |f(x + t) - g(x + t)|d\mu(x) +
			\\
			\int_{[a; b - t]} |g(x + t) - g(x)|d\mu(x) + \int_{[a; b - t]} |g(x) - f(x)|d\mu(x) < \eps
		\end{multline*}
		Оценка первого и последнего интегралов как $\eps / 3$ по отдельности следует из выбора $g$, а интеграл посередине оценивается так же из-за равномерной непрерывности.
	
		\item $f \in L_1(\R)$ --- сведём этот случай к уже доказаному выше. Из суммируемости на множестве бесконечной меры следует, что
		\[
			\forall \eps > 0\ \exists N \in \N \such \int_{\R \bs [-N; N]} |f(x)|dx < \frac{\eps}{3}
		\]
		Зафиксируем $\eps > 0$ и соответствующее $N \in \N$. Для произвольного $t$ мы можем разбить интеграл на такие два:
		\begin{multline*}
			\int_\R |f(x + t) - f(x)|dx = \int_{[-N - 1; N + 1 - t]} |f(x + t) - f(x)|dx +
			\\
			\int_{\R \bs [-N - 1; N + 1 - t]} |f(x + t) - f(x)|dx
		\end{multline*}
		Коль скоро интеграл Лебега обладает абсолютной непрерывностью и $t \to 0$, то рассмотрим только $0 < t < 1$ \textcolor{red}{Не уверен, что это является обоснованием. Спросить и дописать}. Тогда первый интеграл уменьшением $t$ доводится до $< \eps / 3$ (за счёт уже доказанного выше), а второй интеграл разбивается на два по неравенству треугольника и тоже оцениваются как $\eps / 3$ каждый, за счёт свойства выбранного $N$.
	\end{enumerate}
\end{proof}

\begin{theorem} (Римана об осциляции)
	Если $f \in L_1(I)$, где $I$ --- промежуток в $\R$, то существуют следующие пределы:
	\[
		\exists \lim_{\lambda \to \infty} \int_I f(x)\cos(\lambda x)d\mu(x) = \lim_{\lambda \to \infty} \int_I f(x)\sin(\lambda x)d\mu(x) = 0
	\]
\end{theorem}

\begin{note}
	Другими словами, коэффициенты тригонометрического ряда Фурье при увеличении номера обязательно уменьшаются.
\end{note}

\begin{proof}
	Интегралы суть одинаковы, поэтому мы покажем доказательство лишь для одного из них (того, что с косинусом). Разберём случаи:
	\begin{itemize}
		\item $I = \R$. Оценим модуль интеграла:
		\begin{multline*}
			\md{\int_\R f(x)\cos(\lambda x)d\mu(x)} = \md{-\int_\R f\ps{t + \frac{\pi}{\lambda}}\cos(\lambda t)d\mu(t)} =
			\\
			\md{-\frac{1}{2}\int_\R \ps{f\ps{t + \frac{\pi}{\lambda}} - f(t)}\cos(\lambda t)d\mu(t)} \le \frac{1}{2}\int_\R \md{f\ps{t + \frac{\pi}{\lambda}} - f(t)}d\mu(t) \xrightarrow[\lambda \to \infty]{} 0
		\end{multline*}
		В первом равенстве произошла замена переменной $x = t + \pi / \lambda$, во втором --- взяли среднее между полученным интегралом и исходным (просто $x$ на $t$ поменяли).
		
		\item $I \neq \R$ Тогда дополним $f$ нулём за границами промежутка до $\R$. Понятно, что интеграл по $I$ тогда совпадает с интегралом по $\R$, и мы просто ссылаемся на доказанное в предыдущем пункте.
	\end{itemize}
\end{proof}

\begin{corollary}
	Для любой функции, суммируемой на промежутке длиной $2\pi$, её тригонометрические коэффициенты Фурье образуют бесконечно малые последовательности:
	\[
		\lim_{n \to \infty} a_n = \lim_{n \to \infty} b_n = 0
	\]
\end{corollary}

\begin{proposition}
	Если $f \in L_1[-\pi; \pi]$, то имеет место 2 утверждения:
	\begin{itemize}
		\item Если $f$ --- чётная функция, то $b_n = 0$. Ряд Фурье в таком случае называется \textit{обобщённым косинус-рядом Фурье}
		
		\item Если $f$ --- нечётная функция, то $a_n = 0$. Ряд Фурье в таком случае называется \textit{обобщённым синус-рядом Фурье}
	\end{itemize}
\end{proposition}

\begin{proof}
	Посчитаем соответствующие интегралы из ряда Фурье:
	\begin{itemize}
		\item $b_n = \frac{1}{\pi}\int_{-\pi}^\pi f(x)\sin(nx)d\mu(x)$. Заметим, что раз $f$ --- чётная функция, то $f(x)\sin(nx)$ --- нечётная функция. Раз так, то
		\[
			\int_{-\pi}^\pi f(x)\sin(nx)d\mu(x) = \int_{-\pi}^0 f(x)\sin(nx)d\mu(x) + \int_0^\pi f(x)\sin(nx)d\mu(x) = 0
		\]
		
		\item $a_n = \frac{1}{\pi}\int_{-\pi}^\pi f(x)\cos(nx)d\mu(x)$. Действуем аналогично в силу нечётности $f(x)\cos(nx)$
	\end{itemize}
\end{proof}

\begin{note}
	Более того, формулы коэффициентов работают даже тогда, когда $f \notin L_1[0; \pi]$. Достаточно лишь того, чтобы $f(x)\sin x \in L_1[0; \pi]$. Действительно, мы можем переписать интеграл для $f(x)\sin(nx)$ таким образом:
	\[
		\int_{[0; \pi]} f(x)\sin(nx)d\mu(x) = \int_{[0; \pi]} f(x)\sin x \cdot \ps{\frac{\sin(nx)}{\sin x}}d\mu(x)
	\]
	Функция, которая была выделена в скобки, является композицей \textit{многочлена Чебышёва} и тригонометрической функции:
	\[
		\frac{\sin(nx)}{\sin x} = U_{n - 1}(\cos x)
	\]
\end{note}

\begin{example}
	Посчитаем тригонометрический ряд Фурье для $f(x) = \ctg \frac{x}{2} \in L_1[0; \pi]$. Коль скоро это нечётная функция, то нам нужны лишь $b_n$:
	\[
		b_1 = \frac{2}{\pi} \int_0^\pi \frac{\cos(x / 2)}{\sin(x / 2)} \sin xdx = 1
	\]
	Чтобы вычислить остальные члены ряда, посчитаем разницу между следующим и предыдущим коэффициентом:
	\begin{multline*}
		b_{n + 1} - b_n = \frac{2}{\pi} \int_0^\pi \frac{\cos(x / 2)}{\sin(x / 2)}(\sin((n + 1)x) - \sin(nx))dx =
		\\
		\frac{4}{\pi}\int_0^\pi \frac{\cos(x / 2)}{\sin(x / 2)}(\cos((n + 1/2)x) \cdot \sin(x / 2))dx = \frac{2}{\pi}\int_0^\pi (\cos((n + 1)x) + \cos(nx))dx = 0
	\end{multline*}
	То есть котангенсу половины аргумента сопоставлен очень милый ряд:
	\[
		\ctg \frac{x}{2} \sim \sin(x) + \sin(2x) + \sin(3x) + \ldots
	\]
\end{example}

\subsubsection*{Классические ортогональные многочлены и ортогональные системы, с ними связанные}

\begin{enumerate}
	\item Зафиксируем $\alpha, \beta > -1$. Тогда рассмотрим систему из многочленов вида $(1 - x)^{\alpha / 2}(1 + x)^{\beta / 2}P_n^{(\alpha, \beta)}(x)$, $n \in \N_0$, где
	\[
		P_n^{(\alpha, \beta)}(x) = c_n(1 - x)^{-\alpha}(1 + x)^{-\beta} \frac{d^n}{dx^n}\ps{(1 - x)^{\alpha + n}(1 + x)^{\beta + n}} \text{ --- \textit{многочлены Якоби}}
	\]
	При этом система рассматривается на $[-1; 1]$.
	\begin{itemize}
		\item При $\alpha = \beta$ элементы этой системы называются \textit{многочленами Гегенбауэра, или же ультрасферическими многочленами}
		
		\item При $\alpha = \beta = 0$ --- \textit{многочлены Лежандра}
		
		\item При $\alpha = \beta = -\frac{1}{2}$ --- \textit{многочлены Чебышёва первого рода}
		
		\item При $\alpha = \beta = \frac{1}{2}$ --- \textit{многочлены Чебышёва второго рода}
	\end{itemize}

	\item Зафиксируем $\alpha > -1$ и рассмотрим систему, состоящую из элементов вида $x^{\alpha / 2}e^{-x / 2} L_n^{(\alpha)}(x)$, $n \in \N_0$, где
	\[
		L_n^{(\alpha)}(x) = c_n x^{-\alpha}e^x \frac{d^n}{dx^n}(x^{\alpha + n}e^{-x}) \text{ --- \textit{многочлены Лагерра}}
	\]
	При этом система рассматривается на $\lsi{0; +\infty}$.
	
	\item Рассмотрим систему, состоящую из элементов вида $e^{-x^2 / 2}H_n(x)$, $n \in \N_0$, где
	\[
		H_n(x) = c_ne^{x^2} \frac{d^n}{dx^n}(e^{-x^2}) \text{ --- \text{многочлены Эрмита}}
	\]
	При этом система рассматривается на $(-\infty; \infty)$
\end{enumerate}

\begin{note} (Комплексная форма тригонометрического ряда Фурье)
	Тригонометрический ряд Фурье можно переписать следующим образом, используя комплексную экспоненту:
	\begin{multline*}
		\frac{a_0}{2} + \sum_{n = 1}^\infty a_n\cos(nx) + b_n\sin(nx) = \frac{a_0}{2} + \sum_{n = 1}^\infty a_n\frac{e^{inx} + e^{-inx}}{2} + b_n\frac{e^{inx} - e^{-inx}}{2i} =
		\\
		\frac{a_0}{2} + \sum_{n = 1}^\infty \ps{\frac{e^{inx}}{2}(a_n - ib_n) + \frac{e^{-inx}}{2}(a_n + ib_n)} = \sum_{-\infty}^{+\infty} c_ne^{inx}
	\end{multline*}
	Бесконечную сумму надо понимать как 2 суммы от 1 до бесконечности и ещё отдельный ноль. Коэффициенты этого ряда выглядят так:
	\[
		\forall n \in \N \quad c_n = \frac{1}{2\pi} \int_{[-\pi; \pi]} f(x)e^{-inx}d\mu(x)
	\]
\end{note}

\subsection{Сходимость тригонометрических рядов Фурье}

\begin{note}
	Для упрощения записи, мы будем говорить, что $f \in L_{2\pi}$, если $f$ --- $2\pi$-периодическая и $f \in L_1[-\pi; \pi]$
\end{note}

\begin{anote}
	$2\pi$-периодичность подразумевает, что равенство $f(x + 2\pi) = f(x)$ верно для всех разумных $x$. В частности, если рассматривать $f$ как функцию только на отрезке $[a; a + 2\pi]$, то она $2\pi$-периодична по определению при условии $f(a) = f(a + 2\pi)$.
\end{anote}

\begin{lemma}
	Если $f \in L_{2\pi}$, то её $n$-я частичная сумма тригонометрического ряда Фурье $S_n(f, x)$ представима в следующем виде:
	\[
		S_n(f, x) = \frac{a_0}{2} + \sum_{k = 1}^n (a_k\cos(kx) + b_k\sin(kx)) = \frac{1}{\pi}\int_{[-\pi; \pi]} f(u)D_n(u - x)d\mu(u)
	\]
	где $D_n(t)$ есть следующее выражение, называемое \textit{ядром Дирихле}:
	\[
		D_n(t) = \frac{1}{2} + \sum_{k = 1}^n \cos(kt) = \frac{\sin((n + \frac{1}{2})t)}{2\sin(t / 2)}
	\]
\end{lemma}

\begin{proof}
	Подставим все формулы коэффициентов в частичную сумму $S_n(f, x)$:
	\begin{multline*}
		S_n(f, x) = \frac{1}{2}\int_{[-\pi; \pi]} f(u)d\mu(u) +
		\\
		\sum_{k = 1}^n \ps{\frac{\cos(kx)}{\pi}\int_{[-\pi; \pi]} f(u)\cos(ku)d\mu(u) + \frac{\sin(kx)}{\pi}\int_{[-\pi; \pi]} f(u)\sin(ku)d\mu(u)} =
		\\
		\frac{1}{\pi} \int_{[-\pi; \pi]} f(u)\ps{\frac{1}{2} + \sum_{k = 1}^n \cos(kx)\cos(ku) + \sin(kx)\sin(ku)}d\mu(u) =
		\\
		\frac{1}{\pi} \int_{[-\pi; \pi]} f(u)\ps{\frac{1}{2} + \sum_{k = 1}^n \cos(k(u - x))}d\mu(u) = \frac{1}{\pi} \int_{[-\pi; \pi]} f(u)D_n(u - x)d\mu(u)
	\end{multline*}
	Остальные равенства получаются аналогичным образом. Докажем теперь, что сумма ядра Дирихле сворачивается в дробь:
	\begin{multline*}
		\frac{1}{2} + \sum_{k = 1}^n \cos(kt) = \frac{1}{2} + \frac{1}{2}\sum_{k = 1}^n (e^{ikt} + e^{-ikt}) = \frac{1}{2} \sum_{k = -n}^n e^{ikt} = \frac{1}{2} e^{-int} \frac{e^{i(2n + 1)t} - 1}{e^{it} - 1} =
		\\
		\frac{1}{2}\frac{(e^{i(n + 1/2)t} - e^{-i(n + 1/2)t})e^{i(n + 1/2)t}}{(e^{it/2} - e^{-it/2})e^{it/2}e^{int}} = \frac{\sin((n + 1/2)t)}{2\sin(t/2)}
	\end{multline*}
	Пояснение к последнему переходу: просто сокращаем вынесенные части плюс домножаем числитель и знаменатель на $2i$.
\end{proof}

\begin{note}
	Формулу с ядром Дирихле можно ещё записать в следующих видах:
	\begin{itemize}
		\item Заменой $u - x = t$ и сдвигом новых пределов интеграла обратно до $[-\pi; \pi]$ в силу $2\pi$-периодичности можно получить такую формулу:
		\[
			S_n(f, x) = \frac{1}{\pi} \int_{[-\pi; \pi]} f(x + t)D_n(t)d\mu(t)
		\]
		
		\item Заметим, что в форме выше $D_n(t)$ --- чётная функция, поэтому замена $u = -t$ приведёт к такой формуле (потом $u$ я просто заменил на $t$):
		\[
			S_n(f, x) = \frac{1}{\pi} \int_{[-\pi; \pi]} f(x - t)D_n(t)d\mu(t)
		\]
		
		\item Так как выше мы выразили одно и то же при помощи разных формул, то можно, например, взять среднее от них:
		\[
			S_n(f, x) = \frac{S_n(f, x) + S_n(f, x)}{2} = \frac{1}{2\pi} \int_{[-\pi; \pi]} (f(x + t) + f(x - t))D_n(t)d\mu(t)
		\]
		
		\item Дополнительно заметим, что $g(t) = f(x + t) - f(x - t)$ является чётной функцией. Стало быть, можно получить ещё и такую формулу:
		\[
			S_n(f, x) = \frac{1}{\pi} \int_{[0; \pi]} (f(x + t) + f(x - t))D_n(t)d\mu(t)
		\]
	\end{itemize}
\end{note}